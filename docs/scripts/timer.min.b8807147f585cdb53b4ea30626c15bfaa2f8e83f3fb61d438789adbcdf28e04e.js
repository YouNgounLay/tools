document.addEventListener("DOMContentLoaded",function(){const E=document.getElementById("setting-btn"),n=document.getElementById("settings-modal"),M=document.getElementById("close-settings-btn"),x=document.getElementById("save-settings-btn"),k=document.getElementById("focus-time"),j=document.getElementById("break-time"),O=document.getElementById("long-break-time"),r=document.getElementById("timer-display"),s=document.getElementById("timer-title"),o=document.getElementById("timer-btn"),y=document.getElementById("home-btn"),F=document.getElementById("video-btn"),g=document.getElementById("video-container"),m=document.getElementById("focus-video-url"),f=document.getElementById("break-video-url"),w=document.getElementById("set-focus-video"),C=document.getElementById("set-break-video");let e="focus",c=25*60,v=10*60,d=15*60,h=0,t=null;E.addEventListener("click",function(){n.style.display="flex"}),M.addEventListener("click",function(){n.style.display="none"}),x.addEventListener("click",function(){c=parseInt(k.value)*60,v=parseInt(j.value)*60,d=parseInt(O.value)*60,n.style.display="none",l()}),window.addEventListener("click",function(e){e.target===n&&(n.style.display="none")}),o.addEventListener("click",function(){t?(clearInterval(t),t=null,o.textContent="Start"):(b(),o.textContent="Pause")});function b(){let e=i();t=setInterval(function(){if(e<=0){clearInterval(t),t=null,_();return}e--,r.textContent=a(e)},1e3)}function i(){switch(e){case"focus":return c;case"shortBreak":return v;case"longBreak":return d;default:return 0}}function _(){e==="focus"?(h++,h%3===0?(e="longBreak",s.textContent="Long Break"):(e="shortBreak",s.textContent="Break Time")):(e="focus",s.textContent="Focus Time"),r.textContent=a(i()),o.textContent="Start"}function a(e){const t=Math.floor(e/60),n=e%60;return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function l(){r.textContent=a(i()),s.textContent=e==="focus"?"Focus Time":e==="shortBreak"?"Break Time":"Long Break"}y.addEventListener("click",function(){window.location.href="/tools"}),F.addEventListener("click",function(){g.style.display=g.style.display==="block"?"none":"block",p()}),w.addEventListener("click",function(){u("focus",m.value)}),C.addEventListener("click",function(){u("break",f.value)});function T(){const e=document.getElementById("current-video");e.src=`https://www.youtube.com/embed/${S()}`}function S(){return e==="focus"?focusVideoId:e==="break"?breakVideoId:""}function p(){document.getElementById("focus-video").src=`https://www.youtube.com/embed/${focusVideoId}`,document.getElementById("break-video").src=`https://www.youtube.com/embed/${breakVideoId}`,m.value=`https://www.youtube.com/watch?v=${focusVideoId}`,f.value=`https://www.youtube.com/watch?v=${breakVideoId}`}function u(e,t){const n=A(t);e==="focus"?focusVideoId=n:e==="break"&&(breakVideoId=n),p()}function A(e){let t="";const n=e.match(/[?&]v=([^?&]+)/);return n&&(t=n[1]),t}l()})